<%= javascript_include_tag 'd3pie.min' %>
<div class="container-fluid">
  <div class="row">
    <div class="col-lg-2 sidebar text-white">
      <img class="img-fluid mt-2" src="<%= @profile_pic if !@profile_pic.nil?%>" alt="" id="user-profile">
      <h1 class="mt-4"><%= @display_name %></h1>
      <hr>
      <ul class="list-unstyled" id="user-playlists">
        <%=render partial: 'playlist', collection: @names, as: :name%>
      </ul>
    </div>
    <div class="col data">
      <div id="myPie"></div>
    </div>
  </div>
</div>

<%= form_tag(root_path, :method=>"get") do %>
  Search user <%= text_field_tag :user %>
  <%= submit_tag 'Search' %>
<% end %>

<script>
  var pie = new d3pie("myPie", {
	"header": {
		"title": {
			"fontSize": 22,
			"font": "verdana"
		},
		"subtitle": {
			"color": "#999999",
			"fontSize": 10,
			"font": "verdana"
		},
		"titleSubtitlePadding": 12
	},
	"footer": {
		"color": "#999999",
		"fontSize": 11,
		"font": "open sans",
		"location": "bottom-center"
	},
	"size": {
		"canvasHeight": 400,
		"canvasWidth": 590,
		"pieOuterRadius": "88%"
	},
	"data": {
		"content": [
			{
				"label": "When's it going to be done?",
				"value": 40,
				"color": "#7e3838"
			},
			{
				"label": "Bennnnn!",
				"value": 5,
				"color": "#7e4a38"
			}
		]
	},
	"labels": {
		"outer": {
			"format": "none",
			"pieDistance": 32
		},
		"mainLabel": {
			"font": "verdana"
		},
		"percentage": {
			"color": "#e1e1e1",
			"font": "verdana",
			"decimalPlaces": 0
		},
		"value": {
			"color": "#e1e1e1",
			"font": "verdana"
		},
		"truncation": {
			"enabled": true
		}
	},
	"tooltips": {
		"enabled": true,
		"type": "placeholder",
		"string": "{label}: {value}, {percentage}%"
	},
	"effects": {
		"pullOutSegmentOnClick": {
			"effect": "linear",
			"speed": 400,
			"size": 50
		}
	},
	"callbacks": {}
});

$(function() {
	$(".openSegmentBtn").on("click", function(e) {
		var index = parseInt($(e.target).data("index"), 10);
		pie.openSegment(index);
	});

	$("#closeSegmentBtn").on("click", function() {
		pie.closeSegment();
	});
});
</script>